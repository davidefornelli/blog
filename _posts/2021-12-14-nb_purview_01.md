---
keywords: fastai
description: How to create a custom Purview dataset and process with python
title: Purview | Custom process
toc: true
badges: true
comments: true
categories: [purview, python, jupyter]
hide: false
image: images/social/purview_custom_process.png
nb_path: _notebooks/2021-12-14-nb_purview_01.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-12-14-nb_purview_01.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prerequisites">Prerequisites<a class="anchor-link" href="#Prerequisites"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pip</span> install pyapacheatlas
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting pyapacheatlas
  Downloading pyapacheatlas-0.10.0-py3-none-any.whl (68 kB)
     |████████████████████████████████| 68 kB 1.9 MB/s             
Collecting openpyxl&gt;=3.0
  Downloading openpyxl-3.0.9-py2.py3-none-any.whl (242 kB)
     |████████████████████████████████| 242 kB 3.8 MB/s            
Requirement already satisfied: requests&gt;=2.0 in /home/daforne/repos/github/davidefornelli/blog/.venv/lib/python3.7/site-packages (from pyapacheatlas) (2.26.0)
Collecting et-xmlfile
  Using cached et_xmlfile-1.1.0-py3-none-any.whl (4.7 kB)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/daforne/repos/github/davidefornelli/blog/.venv/lib/python3.7/site-packages (from requests&gt;=2.0-&gt;pyapacheatlas) (2021.10.8)
Requirement already satisfied: charset-normalizer~=2.0.0 in /home/daforne/repos/github/davidefornelli/blog/.venv/lib/python3.7/site-packages (from requests&gt;=2.0-&gt;pyapacheatlas) (2.0.7)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /home/daforne/repos/github/davidefornelli/blog/.venv/lib/python3.7/site-packages (from requests&gt;=2.0-&gt;pyapacheatlas) (1.26.7)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/daforne/repos/github/davidefornelli/blog/.venv/lib/python3.7/site-packages (from requests&gt;=2.0-&gt;pyapacheatlas) (3.3)
Installing collected packages: et-xmlfile, openpyxl, pyapacheatlas
Successfully installed et-xmlfile-1.1.0 openpyxl-3.0.9 pyapacheatlas-0.10.0
Note: you may need to restart the kernel to use updated packages.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Code">Code<a class="anchor-link" href="#Code"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import">Import<a class="anchor-link" href="#Import"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyapacheatlas.auth</span> <span class="kn">import</span> <span class="n">ServicePrincipalAuthentication</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.client</span> <span class="kn">import</span> <span class="n">PurviewClient</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.entity</span> <span class="kn">import</span> <span class="n">AtlasEntity</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">EntityTypeDef</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.util</span> <span class="kn">import</span> <span class="n">GuidTracker</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">ChildEndDef</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">RelationshipTypeDef</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">ParentEndDef</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">Cardinality</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core.typedef</span> <span class="kn">import</span> <span class="n">AtlasAttributeDef</span>
<span class="kn">from</span> <span class="nn">pyapacheatlas.core</span> <span class="kn">import</span> <span class="n">AtlasProcess</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Settings">Settings<a class="anchor-link" href="#Settings"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tenant_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">client_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">client_secret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">purview_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clients">Clients<a class="anchor-link" href="#Clients"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">atlas_sp</span> <span class="o">=</span> <span class="n">ServicePrincipalAuthentication</span><span class="p">(</span>
    <span class="n">tenant_id</span><span class="o">=</span><span class="n">tenant_id</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="n">client_secret</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">purview_client</span> <span class="o">=</span> <span class="n">PurviewClient</span><span class="p">(</span>
    <span class="n">account_name</span><span class="o">=</span><span class="n">purview_name</span><span class="p">,</span>
    <span class="n">authentication</span><span class="o">=</span><span class="n">atlas_sp</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Entities">Entities<a class="anchor-link" href="#Entities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">guid_tracker</span> <span class="o">=</span> <span class="n">GuidTracker</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custom_dataset</span> <span class="o">=</span> <span class="n">purview_client</span><span class="o">.</span><span class="n">upload_typedefs</span><span class="p">(</span>
    <span class="n">entityDefs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">EntityTypeDef</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myCustomDataSet&quot;</span><span class="p">,</span>
            <span class="n">superTypes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DataSet&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">force_update</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myCustomDataset01</span> <span class="o">=</span> <span class="n">AtlasEntity</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myCustomDataset01&quot;</span><span class="p">,</span>
    <span class="n">typeName</span><span class="o">=</span><span class="s2">&quot;myCustomDataSet&quot;</span><span class="p">,</span>
    <span class="n">qualified_name</span><span class="o">=</span><span class="s2">&quot;pyapacheatlas://mycustomdataset01&quot;</span><span class="p">,</span>
    <span class="n">guid</span><span class="o">=</span><span class="n">guid_tracker</span><span class="o">.</span><span class="n">get_guid</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">myCustomDataset02</span> <span class="o">=</span> <span class="n">AtlasEntity</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myCustomDataset02&quot;</span><span class="p">,</span>
    <span class="n">typeName</span><span class="o">=</span><span class="s2">&quot;myCustomDataSet&quot;</span><span class="p">,</span>
    <span class="n">qualified_name</span><span class="o">=</span><span class="s2">&quot;pyapacheatlas://mycustomdataset02&quot;</span><span class="p">,</span>
    <span class="n">guid</span><span class="o">=</span><span class="n">guid_tracker</span><span class="o">.</span><span class="n">get_guid</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myCustomProcess01</span> <span class="o">=</span> <span class="n">AtlasProcess</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myCustomProcess01&quot;</span><span class="p">,</span>
    <span class="n">typeName</span><span class="o">=</span><span class="s2">&quot;Process&quot;</span><span class="p">,</span>
    <span class="n">qualified_name</span><span class="o">=</span><span class="s2">&quot;pyapacheatlas://mycustomprocess01&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">myCustomDataset01</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">myCustomDataset02</span><span class="p">],</span>
    <span class="n">guid</span><span class="o">=</span><span class="n">guid_tracker</span><span class="o">.</span><span class="n">get_guid</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">purview_client</span><span class="o">.</span><span class="n">upload_entities</span><span class="p">(</span>
    <span class="n">batch</span><span class="o">=</span><span class="p">[</span><span class="n">myCustomDataset01</span><span class="p">,</span> <span class="n">myCustomDataset02</span><span class="p">,</span> <span class="n">myCustomProcess01</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Result">Result<a class="anchor-link" href="#Result"> </a></h2><p><img src="/images/copied_from_nb/images/purview_custom_process.png" alt="Call graph"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Utils">Utils<a class="anchor-link" href="#Utils"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Delete-entities">Delete entities<a class="anchor-link" href="#Delete-entities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">purview_client</span><span class="o">.</span><span class="n">delete_typedefs</span><span class="p">(</span>
    <span class="n">entityDefs</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;myCustomProcess&quot;</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

